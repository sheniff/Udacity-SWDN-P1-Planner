function DataStore(){return localStorage?(this.USERS_KEY="UdacityEventPlannerUsers",this.CURRENT_USER_KEY="UdacityEventPlannerCurrentUser",this.EVENTS_KEY="UdacityEventPlannerEvents",this.users=JSON.parse(localStorage.getItem(this.USERS_KEY))||{},this.currentUser=JSON.parse(localStorage.getItem(this.CURRENT_USER_KEY)),void(this.events=JSON.parse(localStorage.getItem(this.EVENTS_KEY))||[])):console.warn("[DataStore] Warning: No localStorage in this browser. Persistence won't work!")}function DateRange(t,e){return t&&e?(this.startDate=document.querySelector(t),void(this.endDate=document.querySelector(e))):console.error("No IDs provided for start or end date fields!")}function EventPrinter(t,e,i){this.parent=t,this.template=e,this.noEventsTemplate=i}function FormValidator(t){t&&(this.passwordInput=t.querySelector('input[type="password"]'),this.requiredFields=t.querySelectorAll("input[required]"),this.submit=t.querySelector('[type="submit"]'))}function GravatarFetcher(t){return t?void(this.email=t):console.error("No email field provided!")}function GuestsList(t){return t?(this.group=$(t),this.input=this.group.find("input"),this.datalist=this.group.find("datalist"),this.addGuestBtn=this.group.find(".btn"),this.guestsUl=this.group.find("ul"),this.dataStore=new DataStore,this.usersList=this.dataStore.getUsers(),void(this.guestList=[])):console.error("No ID for group where guests list is has been provided!")}function HostInput(t){return t?(this.group=$(t),this.myselfButton=this.group.find(".choose-myself"),this.input=this.group.find("input"),this.datalist=this.group.find("datalist"),this.dataStore=new DataStore,this.usersList=this.dataStore.getUsers(),void(this.me=this.dataStore.userInfo())):console.error("No ID for group where host input is has been provided!")}function IssueTracker(){this.issues=[]}function LocationInput(t){return t?(this.input=$(t),void(this.datalist=this.input.next("datalist"))):console.error("No ID for input where to place location!")}function NamePrepopulator(t){return t?(this.email=t.querySelector('[type="email"]'),void(this.name=t.querySelector("input#inputName"))):console.error("No form provided!")}function OptionalFieldsRevealer(t){t&&(this.collapsible=t,this.actionable=t.querySelector("input"))}function PasswordRequirementsPopover(t,e){t&&e&&(this.passwordInput=$(e),this.popover=$(t),this.requirements=[{text:"8 - 100 characters long",valid:!1},{text:"Include lowercase characters",valid:!1},{text:"Include uppercase characters",valid:!1},{text:"Include a number",valid:!1},{text:"Include (!, @, #, $, %, ^, &, *)",valid:!1}])}function PasswordRevealer(t){this.password=t.querySelector('[type="password"]'),this.button=t.querySelector(".btn")}function ProgressTracker(t,e,i){return t?e?(this.progressBar=t,this.requiredFields=e.querySelectorAll("input[required]"),this.validFields=[],this.submit=e.querySelector('[type="submit"]'),void(this.disableSubmit=i)):console.error("No form provided!"):console.error("No progressBar provided!")}DataStore.prototype.isLoggedIn=function(){return!!this.currentUser},DataStore.prototype.userInfo=function(){return this.currentUser},DataStore.prototype.userEvents=function(){return this.currentUser?this.events.filter(function(t){return t.creator===this.currentUser.email||t.host===this.currentUser.email||t.guests.includes(this.currentUser.email)}.bind(this)):[]},DataStore.prototype.login=function(t){t instanceof Array&&(t=DataStore.toObject(t)),this.users[t.email]=t,localStorage.setItem(this.USERS_KEY,JSON.stringify(this.users)),this.currentUser=t,localStorage.setItem(this.CURRENT_USER_KEY,JSON.stringify(t))},DataStore.prototype.logout=function(){this.currentUser=null,localStorage.removeItem(this.CURRENT_USER_KEY)},DataStore.toObject=function(t){var e={};return t.forEach(function(t){void 0!==e[t.name]?(e[t.name].push||(e[t.name]=[e[t.name]]),e[t.name].push(t.value||"")):e[t.name]=t.value||""}),e},DataStore.prototype.getUsers=function(){return this.users},DataStore.prototype.saveEvent=function(t){t instanceof Array&&(t=DataStore.toObject(t)),t.creator=this.userInfo().email,this.events.push(t),localStorage.setItem(this.EVENTS_KEY,JSON.stringify(this.events))},DateRange.prototype.enable=function(){var t=new Date,e=function(t){return new Date(t).toISOString().slice(0,-8)},i=e(t.getTime()-6e4*t.getTimezoneOffset());this.startDate.min=i,this.startDate.value=i,this.endDate.min=i,this.endDate.value=e(new Date(i).getTime()+36e5),this.startDate.addEventListener("change",function(t){this.endDate.value=e(new Date(t.target.value).getTime()+36e5)}.bind(this))},EventPrinter.prototype.printEvents=function(t){if(this.clearEventList(),t instanceof Array&&this.parent&&this.template){if(!t.length)return this.printNoEvents();for(var e=0;e<t.length;e++)this.printEvent(t[e])}},EventPrinter.prototype.printEvent=function(t){t instanceof Object&&this.parent&&this.template&&(card=document.createElement("div"),card.innerHTML=this.template.text,this.populate(card,t),this.parent.appendChild(card))},EventPrinter.prototype.printNoEvents=function(){this.noEventsTemplate&&this.parent&&(this.parent.innerHTML=this.noEventsTemplate.text)},EventPrinter.prototype.clearEventList=function(){this.parent&&(this.parent.innerHTML="")},EventPrinter.prototype.populate=function(t,e){if(t&&e instanceof Object)for(var i in e)if(e.hasOwnProperty(i))for(var s=t.querySelectorAll("."+i),r=0;r<s.length;r++){var n=e[i];n instanceof Array&&(n=e.join(", ")),s[r].dataset&&"date"===s[r].dataset.type&&(n=new Date(n).toLocaleString()),s[r].innerHTML=n}},FormValidator.prototype.validateOnChange=function(){for(var t=0;t<this.requiredFields.length;t++){var e=this.requiredFields[t];e.addEventListener("keyup",function(t){this.parentNode.classList[t.target.validity.valid?"add":"remove"]("valid")}.bind(e))}},FormValidator.prototype.enablePasswordValidation=function(){var t=function(){var t=this.passwordInput.value,e=new IssueTracker;this.checkRequirements(t,e),this.passwordInput.setCustomValidity(e.retrieve())}.bind(this);this.submit.addEventListener("click",t),this.passwordInput.addEventListener("keyup",t)},FormValidator.prototype.checkRequirements=function(t,e){t.length<8?e.add("fewer than 8 characters"):t.length>100&&e.add("greater than 100 characters"),t.match(/[\!\@\#\$\%\^\&\*]/g)||e.add("missing a symbol (!, @, #, $, %, ^, &, *)"),t.match(/\d/g)||e.add("missing a number"),t.match(/[a-z]/g)||e.add("missing a lowercase letter"),t.match(/[A-Z]/g)||e.add("missing an uppercase letter");var i=t.match(/[^A-z0-9\!\@\#\$\%\^\&\*]/g);i&&i.forEach(function(t){e.add("includes illegal character: "+t)})},GravatarFetcher.prototype.attachTo=function(t){return t?(this.img=t,void this.email.addEventListener("blur",function(){this.email.checkValidity()&&this.showGravatar(this.email.value,this.img)}.bind(this))):console.error("No img object given to attach gravatar!")},GravatarFetcher.prototype.showGravatar=function(t,e){var i=MD5(t);console.log("hash!",i,t),e.src="http://www.gravatar.com/avatar/"+i+"?s=300"},GuestsList.prototype.enable=function(){this.populateDatalist(),this.enableGuestsList()},GuestsList.prototype.populateDatalist=function(){this.datalist.empty();for(var t in this.usersList){var e=document.createElement("option");e.value=t,this.datalist.append(e)}},GuestsList.prototype.enableGuestsList=function(){var t=function(){var t=this.input.val();"string"==typeof t&&t.length&&this.input.is(":valid")&&(this.addGuest(t),this.input.val(""),this.printList())},e=function(t){var e=$(t.target).closest("li").text();this.removeGuest(e),this.printList()};this.addGuestBtn.off().on("click",t.bind(this)),this.input.off().on("change",t.bind(this)),this.guestsUl.off().on("click","a.remove",e.bind(this))},GuestsList.prototype.addGuest=function(t){"string"!=typeof t||this.guestList.includes(t)||this.guestList.push(t)},GuestsList.prototype.removeGuest=function(t){var e=this.guestList.indexOf(t);e>-1&&this.guestList.splice(e,1)},GuestsList.prototype.printList=function(){this.guestsUl.empty();for(var t in this.guestList){var e=document.createElement("li");e.textContent=this.guestList[t];var i=$('<a class="remove"><i class="glyphicon glyphicon-remove"></i></a>');e.appendChild(i.get(0)),this.guestsUl.append(e)}},HostInput.prototype.enable=function(){this.enableClickToChooseMyself(),this.populateDatalist()},HostInput.prototype.enableClickToChooseMyself=function(){this.myselfButton.off().on("click",function(){this.input.val(this.me.email)}.bind(this))},HostInput.prototype.populateDatalist=function(){this.datalist.empty();for(var t in this.usersList){var e=document.createElement("option");e.value=t,this.datalist.append(e)}},IssueTracker.prototype={add:function(t){this.issues.push(t)},retrieve:function(){var t="";switch(this.issues.length){case 0:break;case 1:t="Please correct the following issue:\n"+this.issues[0];break;default:t="Please correct the following issues:\n"+this.issues.join("\n")}return t}},LocationInput.prototype.enable=function(){google&&google.maps&&google.maps.places&&(this.printList(["Finding places nearby..."]),google.maps.event.addDomListener(window,"load",this.initGooglePlaces.bind(this)))},LocationInput.prototype.updateLocationList=function(t){var e=function(t,e){e==google.maps.places.PlacesServiceStatus.OK?this.printList(t.map(function(t){return t.name})):this.printList(["No suggestions found"])};this.googlePlaces.nearbySearch({location:new google.maps.LatLng(t.coords.latitude,t.coords.longitude),radius:"500"},e.bind(this)),this.printList(["Finding places..."])},LocationInput.prototype.getLocation=function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(t,e):console.log("WARNING: Geolocation not supported by this browser...")},LocationInput.prototype.printList=function(t){if(this.datalist.empty(),t instanceof Array)for(var e in t){var i=document.createElement("option");i.value=t[e],this.datalist.append(i)}},LocationInput.prototype.initGooglePlaces=function(){this.googlePlaces=new google.maps.places.PlacesService(new google.maps.Map(document.getElementById("map"))),this.input.off().on("focus",function(){this.getLocation(this.updateLocationList.bind(this))}.bind(this))},NamePrepopulator.prototype.enable=function(){this.email.addEventListener("blur",function(){this.email.checkValidity()&&!this.name.value.length&&(this.name.value=this.email.value.split("@")[0])}.bind(this))},OptionalFieldsRevealer.prototype.enable=function(){this.actionable.addEventListener("focus",function(){this.collapsible.classList.remove("collapsed")}.bind(this)),this.collapsible.addEventListener("click",function(){this.collapsible.classList.contains("collapsed")&&this.actionable.focus()}.bind(this))},PasswordRequirementsPopover.prototype.enable=function(){this.popover.popover(),this.validateRequirements(this.passwordInput.val()),this.printRequirements(),this.passwordInput.on("keyup",function(t){this.validateRequirements(this.passwordInput.val()),this.printRequirements(),this.popover.popover("show")}.bind(this))},PasswordRequirementsPopover.prototype.validateRequirements=function(t){this.requirements[0].valid=t.length>=8&&t.length<=100,this.requirements[1].valid=t.match(/[a-z]/g),this.requirements[2].valid=t.match(/[A-Z]/g),this.requirements[3].valid=t.match(/\d/g),this.requirements[4].valid=t.match(/[\!\@\#\$\%\^\&\*]/g)},PasswordRequirementsPopover.prototype.printRequirements=function(){var t='<ul class="list-unstyled">';for(var e in this.requirements)if(this.requirements.hasOwnProperty(e)){var i=this.requirements[e],s='<i class="text-'+(i.valid?"success":"danger")+" glyphicon glyphicon-"+(i.valid?"ok":"remove")+'"></i>';t+="<li>"+s+" "+i.text+"</li>"}t+="</ul>",this.popover.attr("data-content",t)},PasswordRevealer.prototype.enableToggle=function(){this.button.addEventListener("click",function(){var t=this.button.querySelector("i");t.classList.toggle("glyphicon-eye-open"),t.classList.toggle("glyphicon-eye-close"),this.password.type="password"===this.password.type?"text":"password"}.bind(this))},ProgressTracker.prototype.enable=function(){for(var t=0;t<this.requiredFields.length;t++){var e=this.requiredFields[t];e.addEventListener("keyup",function(t){this.updateTracker(t.target)}.bind(this))}this.updateProgressBar()},ProgressTracker.prototype.addValidField=function(t){return this.validFields.indexOf(t)<0&&this.validFields.push(t),this},ProgressTracker.prototype.removeValidField=function(t){return this.validFields.indexOf(t)>-1&&this.validFields.splice(this.validFields.indexOf(t),1),this},ProgressTracker.prototype.updateProgressBar=function(){return this.progressBar.max=this.requiredFields.length,this.progressBar.value=this.validFields.length,this.disableSubmit&&(this.progressBar.value===this.progressBar.max?this.submit.removeAttribute("disabled"):this.submit.setAttribute("disabled","disabled")),this},ProgressTracker.prototype.updateTracker=function(t){return t.checkValidity()?this.addValidField(t):this.removeValidField(t),this.updateProgressBar(),this};var MD5=function(t){function e(t,e){return t<<e|t>>>32-e}function i(t,e){var i,s,r,n,o;return r=2147483648&t,n=2147483648&e,i=1073741824&t,s=1073741824&e,o=(1073741823&t)+(1073741823&e),i&s?2147483648^o^r^n:i|s?1073741824&o?3221225472^o^r^n:1073741824^o^r^n:o^r^n}function s(t,e,i){return t&e|~t&i}function r(t,e,i){return t&i|e&~i}function n(t,e,i){return t^e^i}function o(t,e,i){return e^(t|~i)}function a(t,r,n,o,a,u,l){return t=i(t,i(i(s(r,n,o),a),l)),i(e(t,u),r)}function u(t,s,n,o,a,u,l){return t=i(t,i(i(r(s,n,o),a),l)),i(e(t,u),s)}function l(t,s,r,o,a,u,l){return t=i(t,i(i(n(s,r,o),a),l)),i(e(t,u),s)}function c(t,s,r,n,a,u,l){return t=i(t,i(i(o(s,r,n),a),l)),i(e(t,u),s)}function h(t){for(var e,i=t.length,s=i+8,r=(s-s%64)/64,n=16*(r+1),o=Array(n-1),a=0,u=0;i>u;)e=(u-u%4)/4,a=u%4*8,o[e]=o[e]|t.charCodeAt(u)<<a,u++;return e=(u-u%4)/4,a=u%4*8,o[e]=o[e]|128<<a,o[n-2]=i<<3,o[n-1]=i>>>29,o}function p(t){var e,i,s="",r="";for(i=0;3>=i;i++)e=t>>>8*i&255,r="0"+e.toString(16),s+=r.substr(r.length-2,2);return s}function d(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);128>s?e+=String.fromCharCode(s):s>127&&2048>s?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e}var v,f,g,m,y,b,S,E,L,w=Array(),q=7,I=12,P=17,D=22,R=5,T=9,k=14,N=20,U=4,C=11,F=16,G=23,O=6,x=10,A=15,V=21;for(t=d(t),w=h(t),b=1732584193,S=4023233417,E=2562383102,L=271733878,v=0;v<w.length;v+=16)f=b,g=S,m=E,y=L,b=a(b,S,E,L,w[v+0],q,3614090360),L=a(L,b,S,E,w[v+1],I,3905402710),E=a(E,L,b,S,w[v+2],P,606105819),S=a(S,E,L,b,w[v+3],D,3250441966),b=a(b,S,E,L,w[v+4],q,4118548399),L=a(L,b,S,E,w[v+5],I,1200080426),E=a(E,L,b,S,w[v+6],P,2821735955),S=a(S,E,L,b,w[v+7],D,4249261313),b=a(b,S,E,L,w[v+8],q,1770035416),L=a(L,b,S,E,w[v+9],I,2336552879),E=a(E,L,b,S,w[v+10],P,4294925233),S=a(S,E,L,b,w[v+11],D,2304563134),b=a(b,S,E,L,w[v+12],q,1804603682),L=a(L,b,S,E,w[v+13],I,4254626195),E=a(E,L,b,S,w[v+14],P,2792965006),S=a(S,E,L,b,w[v+15],D,1236535329),b=u(b,S,E,L,w[v+1],R,4129170786),L=u(L,b,S,E,w[v+6],T,3225465664),E=u(E,L,b,S,w[v+11],k,643717713),S=u(S,E,L,b,w[v+0],N,3921069994),b=u(b,S,E,L,w[v+5],R,3593408605),L=u(L,b,S,E,w[v+10],T,38016083),E=u(E,L,b,S,w[v+15],k,3634488961),S=u(S,E,L,b,w[v+4],N,3889429448),b=u(b,S,E,L,w[v+9],R,568446438),L=u(L,b,S,E,w[v+14],T,3275163606),E=u(E,L,b,S,w[v+3],k,4107603335),S=u(S,E,L,b,w[v+8],N,1163531501),b=u(b,S,E,L,w[v+13],R,2850285829),L=u(L,b,S,E,w[v+2],T,4243563512),E=u(E,L,b,S,w[v+7],k,1735328473),S=u(S,E,L,b,w[v+12],N,2368359562),b=l(b,S,E,L,w[v+5],U,4294588738),L=l(L,b,S,E,w[v+8],C,2272392833),E=l(E,L,b,S,w[v+11],F,1839030562),S=l(S,E,L,b,w[v+14],G,4259657740),b=l(b,S,E,L,w[v+1],U,2763975236),L=l(L,b,S,E,w[v+4],C,1272893353),E=l(E,L,b,S,w[v+7],F,4139469664),S=l(S,E,L,b,w[v+10],G,3200236656),b=l(b,S,E,L,w[v+13],U,681279174),L=l(L,b,S,E,w[v+0],C,3936430074),E=l(E,L,b,S,w[v+3],F,3572445317),S=l(S,E,L,b,w[v+6],G,76029189),b=l(b,S,E,L,w[v+9],U,3654602809),L=l(L,b,S,E,w[v+12],C,3873151461),E=l(E,L,b,S,w[v+15],F,530742520),S=l(S,E,L,b,w[v+2],G,3299628645),b=c(b,S,E,L,w[v+0],O,4096336452),L=c(L,b,S,E,w[v+7],x,1126891415),E=c(E,L,b,S,w[v+14],A,2878612391),S=c(S,E,L,b,w[v+5],V,4237533241),b=c(b,S,E,L,w[v+12],O,1700485571),L=c(L,b,S,E,w[v+3],x,2399980690),E=c(E,L,b,S,w[v+10],A,4293915773),S=c(S,E,L,b,w[v+1],V,2240044497),b=c(b,S,E,L,w[v+8],O,1873313359),L=c(L,b,S,E,w[v+15],x,4264355552),E=c(E,L,b,S,w[v+6],A,2734768916),S=c(S,E,L,b,w[v+13],V,1309151649),b=c(b,S,E,L,w[v+4],O,4149444226),L=c(L,b,S,E,w[v+11],x,3174756917),E=c(E,L,b,S,w[v+2],A,718787259),S=c(S,E,L,b,w[v+9],V,3951481745),b=i(b,f),S=i(S,g),E=i(E,m),L=i(L,y);var B=p(b)+p(S)+p(E)+p(L);return B.toLowerCase()};