function DataStore(){return localStorage?(this.USERS_KEY="UdacityEventPlannerUsers",this.CURRENT_USER_KEY="UdacityEventPlannerCurrentUser",this.EVENTS_KEY="UdacityEventPlannerEvents",this.users=JSON.parse(localStorage.getItem(this.USERS_KEY))||{},this.currentUser=JSON.parse(localStorage.getItem(this.CURRENT_USER_KEY)),void(this.events=JSON.parse(localStorage.getItem(this.EVENTS_KEY))||[])):window.console.warn("[DataStore] Warning: No localStorage in this browser. Persistence won't work!")}function DateRange(t,e){return t&&e?(this.startDate=document.querySelector(t),void(this.endDate=document.querySelector(e))):window.console.error("No IDs provided for start or end date fields!")}function EventPrinter(t,e,i){this.parent=t,this.template=e,this.noEventsTemplate=i}function FormValidator(t){t&&(this.passwordInput=t.querySelector('input[type="password"]'),this.requiredFields=t.querySelectorAll("input[required]"),this.submit=t.querySelector('[type="submit"]'))}function GravatarFetcher(t){return t?void(this.email=t):window.console.error("No email field provided!")}function GuestsList(t){return t?(this.group=window.$(t),this.input=this.group.find("input"),this.datalist=this.group.find("datalist"),this.addGuestBtn=this.group.find(".btn"),this.guestsUl=this.group.find("ul"),this.dataStore=new window.DataStore,this.usersList=this.dataStore.getUsers(),void(this.guestList=[])):window.console.error("No ID for group where guests list is has been provided!")}function HostInput(t){return t?(this.group=window.$(t),this.myselfButton=this.group.find(".choose-myself"),this.input=this.group.find("input"),this.datalist=this.group.find("datalist"),this.dataStore=new window.DataStore,this.usersList=this.dataStore.getUsers(),void(this.me=this.dataStore.userInfo())):window.console.error("No ID for group where host input is has been provided!")}function IssueTracker(){this.issues=[]}function LocationInput(t){return t?(this.input=window.$(t),void(this.datalist=this.input.next("datalist"))):window.console.error("No ID for input where to place location!")}function NamePrepopulator(t){return t?(this.email=t.querySelector('[type="email"]'),void(this.name=t.querySelector("input#inputName"))):window.console.error("No form provided!")}function OptionalFieldsRevealer(t){t&&(this.collapsible=t,this.actionable=t.querySelector("input"))}function PasswordRequirementsPopover(t,e){t&&e&&(this.passwordInput=window.$(e),this.popover=window.$(t),this.requirements=[{text:"8 - 100 characters long",valid:!1},{text:"Include lowercase characters",valid:!1},{text:"Include uppercase characters",valid:!1},{text:"Include a number",valid:!1},{text:"Include (!, @, #, $, %, ^, &, *)",valid:!1}])}function PasswordRevealer(t){this.password=t.querySelector('[type="password"]'),this.button=t.querySelector(".btn")}function ProgressTracker(t,e,i){return t?e?(this.progressBar=t,this.requiredFields=e.querySelectorAll("input[required]"),this.validFields=[],this.submit=e.querySelector('[type="submit"]'),void(this.disableSubmit=i)):window.console.error("No form provided!"):window.console.error("No progressBar provided!")}DataStore.prototype.isLoggedIn=function(){return!!this.currentUser},DataStore.prototype.userInfo=function(){return this.currentUser},DataStore.prototype.userEvents=function(){if(!this.currentUser)return[];var t=this.events.filter(function(t){return t.creator===this.currentUser.email||t.host===this.currentUser.email||t.guests.includes(this.currentUser.email)}.bind(this));return t.length||(t=[{title:"Party @ Example.org!",host:"organizer@example.org",guests:["myfriend@example.org","thatguy@example.org","you@example.org"],start:new Date(2016,2,10,20),end:new Date(2016,2,10,22),location:"Example.org HQ (777 Bryant St)",message:"Let's all have fun together celebrating the 150th anniversary of this emblematic fake company!"}]),t},DataStore.prototype.login=function(t){t instanceof Array&&(t=DataStore.toObject(t)),this.users[t.email]=t,localStorage.setItem(this.USERS_KEY,JSON.stringify(this.users)),this.currentUser=t,localStorage.setItem(this.CURRENT_USER_KEY,JSON.stringify(t))},DataStore.prototype.logout=function(){this.currentUser=null,localStorage.removeItem(this.CURRENT_USER_KEY)},DataStore.prototype.getUsers=function(){return this.users},DataStore.prototype.saveEvent=function(t){t instanceof Array&&(t=DataStore.toObject(t)),t.creator=this.userInfo().email,this.events.push(t),localStorage.setItem(this.EVENTS_KEY,JSON.stringify(this.events))},DataStore.toObject=function(t){var e={};return t.forEach(function(t){void 0!==e[t.name]?(e[t.name].push||(e[t.name]=[e[t.name]]),e[t.name].push(t.value||"")):e[t.name]=t.value||""}),e},DateRange.prototype.enable=function(){var t=new Date,e=function(t){return new Date(t).toISOString().slice(0,-8)},i=e(t.getTime()-6e4*t.getTimezoneOffset());this.startDate.min=i,this.startDate.value=i,this.endDate.min=i,this.endDate.value=e(new Date(i).getTime()+36e5),this.startDate.addEventListener("change",function(t){this.endDate.value=e(new Date(t.target.value).getTime()+36e5)}.bind(this))},EventPrinter.prototype.printEvents=function(t){if(this.clearEventList(),t instanceof Array&&this.parent&&this.template){if(!t.length)return this.printNoEvents();for(var e=0;e<t.length;e++)this.printEvent(t[e])}},EventPrinter.prototype.printEvent=function(t){if(t instanceof Object&&this.parent&&this.template){var e=document.createElement("div");e.innerHTML=this.template.text,this.populate(e,t),this.parent.appendChild(e)}},EventPrinter.prototype.printNoEvents=function(){this.noEventsTemplate&&this.parent&&(this.parent.innerHTML=this.noEventsTemplate.text)},EventPrinter.prototype.clearEventList=function(){this.parent&&(this.parent.innerHTML="")},EventPrinter.prototype.populate=function(t,e){if(t&&e instanceof Object)for(var i in e)if(e.hasOwnProperty(i))for(var s=t.querySelectorAll("."+i),n=0;n<s.length;n++){var r=e[i];r instanceof Array&&(r=r.join(", ")),s[n].dataset&&"date"===s[n].dataset.type&&(r=new Date(r).toLocaleString()),s[n].innerHTML=r}},FormValidator.prototype.validateOnChange=function(){for(var t=function(t){window.setTimeout(function(){t.reportValidity()},1)},e=0;e<this.requiredFields.length;e++){var i=this.requiredFields[e];i.addEventListener("keyup",function(t){this.parentNode.classList[t.target.checkValidity()?"add":"remove"]("valid")}.bind(i)),i.addEventListener("change",function(e){this.parentNode.classList[e.target.checkValidity()?"add":"remove"]("valid"),t(this)}.bind(i))}},FormValidator.prototype.enablePasswordValidation=function(){var t=function(){var t=this.passwordInput.value,e=new window.IssueTracker;this.checkRequirements(t,e),this.passwordInput.setCustomValidity(e.retrieve())}.bind(this);this.submit.addEventListener("click",t),this.passwordInput.addEventListener("keyup",t)},FormValidator.prototype.checkRequirements=function(t,e){t.length<8?e.add("fewer than 8 characters"):t.length>100&&e.add("greater than 100 characters"),t.match(/[\!\@\#\$\%\^\&\*]/g)||e.add("missing a symbol (!, @, #, $, %, ^, &, *)"),t.match(/\d/g)||e.add("missing a number"),t.match(/[a-z]/g)||e.add("missing a lowercase letter"),t.match(/[A-Z]/g)||e.add("missing an uppercase letter");var i=t.match(/[^A-z0-9\!\@\#\$\%\^\&\*]/g);i&&i.forEach(function(t){e.add("includes illegal character: "+t)})},GravatarFetcher.prototype.attachTo=function(t){return t?(this.img=t,void this.email.addEventListener("blur",function(){this.email.checkValidity()&&this.showGravatar(this.email.value,this.img)}.bind(this))):window.console.error("No img object given to attach gravatar!")},GravatarFetcher.prototype.showGravatar=function(t,e){var i=window.MD5(t);e.src="http://www.gravatar.com/avatar/"+i+"?s=300"},GuestsList.prototype.enable=function(){this.populateDatalist(),this.enableGuestsList(),this._invalidateEmptyList()},GuestsList.prototype.populateDatalist=function(){this.datalist.empty();for(var t in this.usersList){var e=document.createElement("option");e.value=t,this.datalist.append(e)}},GuestsList.prototype.enableGuestsList=function(){var t=function(){var t=this.input.val(),e=this.input.get(0);e.validity.valueMissing||e.validity.typeMismatch||(this.addGuest(t),this.input.val(""),this.printList(),e.setCustomValidity(""))},e=function(t){var e=window.$(t.target).closest("li").text();this.removeGuest(e),this.printList(),this._invalidateEmptyList()};this.addGuestBtn.off().on("click",t.bind(this)),this.input.off().on("change",t.bind(this)),this.guestsUl.off().on("click","a.remove",e.bind(this))},GuestsList.prototype.addGuest=function(t){"string"!=typeof t||this.guestList.includes(t)||this.guestList.push(t)},GuestsList.prototype.removeGuest=function(t){var e=this.guestList.indexOf(t);e>-1&&this.guestList.splice(e,1)},GuestsList.prototype.printList=function(){this.guestsUl.empty();for(var t in this.guestList){var e=document.createElement("li");e.textContent=this.guestList[t];var i=window.$('<a class="remove"><i class="glyphicon glyphicon-remove"></i></a>');e.appendChild(i.get(0)),this.guestsUl.append(e)}},GuestsList.prototype._invalidateEmptyList=function(){this.guestList.length||this.input.get(0).setCustomValidity("You should invite at least one person to your event.")},HostInput.prototype.enable=function(){this.enableClickToChooseMyself(),this.populateDatalist()},HostInput.prototype.enableClickToChooseMyself=function(){this.myselfButton.off().on("click",function(){this.input.val(this.me.email)}.bind(this))},HostInput.prototype.populateDatalist=function(){this.datalist.empty();for(var t in this.usersList){var e=document.createElement("option");e.value=t,this.datalist.append(e)}},IssueTracker.prototype={add:function(t){this.issues.push(t)},retrieve:function(){var t="";switch(this.issues.length){case 0:break;case 1:t="Please correct the following issue:\n"+this.issues[0];break;default:t="Please correct the following issues:\n"+this.issues.join("\n")}return t}},LocationInput.prototype.enable=function(){window.google&&window.google.maps&&window.google.maps.places&&(this.printList(["Finding places nearby..."]),window.google.maps.event.addDomListener(window,"load",this.initGooglePlaces.bind(this)))},LocationInput.prototype.updateLocationList=function(t){var e=function(t,e){e==window.google.maps.places.PlacesServiceStatus.OK?this.printList(t.map(function(t){return t.name})):this.printList(["No suggestions found"])};this.googlePlaces.nearbySearch({location:new window.google.maps.LatLng(t.coords.latitude,t.coords.longitude),radius:"500"},e.bind(this)),this.printList(["Finding places..."])},LocationInput.prototype.getLocation=function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(t,e):window.console.log("WARNING: Geolocation not supported by this browser...")},LocationInput.prototype.printList=function(t){if(this.datalist.empty(),t instanceof Array)for(var e in t){var i=document.createElement("option");i.value=t[e],this.datalist.append(i)}},LocationInput.prototype.initGooglePlaces=function(){this.googlePlaces=new window.google.maps.places.PlacesService(new window.google.maps.Map(document.getElementById("map"))),this.input.off().on("focus",function(){this.getLocation(this.updateLocationList.bind(this))}.bind(this))},NamePrepopulator.prototype.enable=function(){this.email.addEventListener("blur",function(){if(this.email.checkValidity()&&!this.name.value.length)if(this.name.value=this.email.value.split("@")[0],"createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("keyup",!1,!0),this.name.dispatchEvent(t)}else this.name.fireEvent("onkeyup")}.bind(this))},OptionalFieldsRevealer.prototype.enable=function(){this.actionable.addEventListener("focus",function(){this.collapsible.classList.remove("collapsed")}.bind(this)),this.collapsible.addEventListener("click",function(){this.collapsible.classList.contains("collapsed")&&this.actionable.focus()}.bind(this))},PasswordRequirementsPopover.prototype.enable=function(){this.popover.popover(),this.validateRequirements(this.passwordInput.val()),this.printRequirements(),this.passwordInput.on("keyup",function(){var t=this.validateRequirements(this.passwordInput.val());this.printRequirements(),this.popover.popover("show"),this.passwordInput.get(0).setCustomValidity(t?"":"Invalid password. Follow the tips above.")}.bind(this))},PasswordRequirementsPopover.prototype.validateRequirements=function(t){return this.requirements[0].valid=t.length>=8&&t.length<=100,this.requirements[1].valid=!!t.match(/[a-z]/g),this.requirements[2].valid=!!t.match(/[A-Z]/g),this.requirements[3].valid=!!t.match(/\d/g),this.requirements[4].valid=!!t.match(/[\!\@\#\$\%\^\&\*]/g),this.requirements.reduce(function(t,e){return t&&e.valid},!0)},PasswordRequirementsPopover.prototype.printRequirements=function(){var t='<ul class="list-unstyled">';for(var e in this.requirements)if(this.requirements.hasOwnProperty(e)){var i=this.requirements[e],s='<i class="text-'+(i.valid?"success":"danger")+" glyphicon glyphicon-"+(i.valid?"ok":"remove")+'"></i>';t+="<li>"+s+" "+i.text+"</li>"}t+="</ul>",this.popover.attr("data-content",t)},PasswordRevealer.prototype.enableToggle=function(){this.button.addEventListener("click",function(){var t=this.button.querySelector("i");t.classList.toggle("glyphicon-eye-open"),t.classList.toggle("glyphicon-eye-close"),this.password.type="password"===this.password.type?"text":"password"}.bind(this))},ProgressTracker.prototype.enable=function(){for(var t=0;t<this.requiredFields.length;t++){var e=this.requiredFields[t];e.addEventListener("keyup",function(t){this.updateTracker(t.target)}.bind(this))}this.updateProgressBar()},ProgressTracker.prototype.addValidField=function(t){return this.validFields.indexOf(t)<0&&this.validFields.push(t),this},ProgressTracker.prototype.removeValidField=function(t){return this.validFields.indexOf(t)>-1&&this.validFields.splice(this.validFields.indexOf(t),1),this},ProgressTracker.prototype.updateProgressBar=function(){return this.progressBar.max=this.requiredFields.length,this.progressBar.value=this.validFields.length,this.disableSubmit&&(this.progressBar.value===this.progressBar.max?this.submit.removeAttribute("disabled"):this.submit.setAttribute("disabled","disabled")),this},ProgressTracker.prototype.updateTracker=function(t){return t.checkValidity()?this.addValidField(t):this.removeValidField(t),this.updateProgressBar(),this},window.MD5=function(t){function e(t,e){return t<<e|t>>>32-e}function i(t,e){var i,s,n,r,o;return n=2147483648&t,r=2147483648&e,i=1073741824&t,s=1073741824&e,o=(1073741823&t)+(1073741823&e),i&s?2147483648^o^n^r:i|s?1073741824&o?3221225472^o^n^r:1073741824^o^n^r:o^n^r}function s(t,e,i){return t&e|~t&i}function n(t,e,i){return t&i|e&~i}function r(t,e,i){return t^e^i}function o(t,e,i){return e^(t|~i)}function a(t,n,r,o,a,u,l){return t=i(t,i(i(s(n,r,o),a),l)),i(e(t,u),n)}function u(t,s,r,o,a,u,l){return t=i(t,i(i(n(s,r,o),a),l)),i(e(t,u),s)}function l(t,s,n,o,a,u,l){return t=i(t,i(i(r(s,n,o),a),l)),i(e(t,u),s)}function h(t,s,n,r,a,u,l){return t=i(t,i(i(o(s,n,r),a),l)),i(e(t,u),s)}function d(t){for(var e,i=t.length,s=i+8,n=(s-s%64)/64,r=16*(n+1),o=Array(r-1),a=0,u=0;i>u;)e=(u-u%4)/4,a=u%4*8,o[e]=o[e]|t.charCodeAt(u)<<a,u++;return e=(u-u%4)/4,a=u%4*8,o[e]=o[e]|128<<a,o[r-2]=i<<3,o[r-1]=i>>>29,o}function c(t){var e,i,s="",n="";for(i=0;3>=i;i++)e=t>>>8*i&255,n="0"+e.toString(16),s+=n.substr(n.length-2,2);return s}function p(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);128>s?e+=String.fromCharCode(s):s>127&&2048>s?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e}var v,g,f,m,y,w,b,E,S,L=Array(),q=7,I=12,P=17,D=22,k=5,T=9,R=14,C=20,N=4,U=11,F=16,x=23,G=6,O=10,V=15,A=21;for(t=p(t),L=d(t),w=1732584193,b=4023233417,E=2562383102,S=271733878,v=0;v<L.length;v+=16)g=w,f=b,m=E,y=S,w=a(w,b,E,S,L[v+0],q,3614090360),S=a(S,w,b,E,L[v+1],I,3905402710),E=a(E,S,w,b,L[v+2],P,606105819),b=a(b,E,S,w,L[v+3],D,3250441966),w=a(w,b,E,S,L[v+4],q,4118548399),S=a(S,w,b,E,L[v+5],I,1200080426),E=a(E,S,w,b,L[v+6],P,2821735955),b=a(b,E,S,w,L[v+7],D,4249261313),w=a(w,b,E,S,L[v+8],q,1770035416),S=a(S,w,b,E,L[v+9],I,2336552879),E=a(E,S,w,b,L[v+10],P,4294925233),b=a(b,E,S,w,L[v+11],D,2304563134),w=a(w,b,E,S,L[v+12],q,1804603682),S=a(S,w,b,E,L[v+13],I,4254626195),E=a(E,S,w,b,L[v+14],P,2792965006),b=a(b,E,S,w,L[v+15],D,1236535329),w=u(w,b,E,S,L[v+1],k,4129170786),S=u(S,w,b,E,L[v+6],T,3225465664),E=u(E,S,w,b,L[v+11],R,643717713),b=u(b,E,S,w,L[v+0],C,3921069994),w=u(w,b,E,S,L[v+5],k,3593408605),S=u(S,w,b,E,L[v+10],T,38016083),E=u(E,S,w,b,L[v+15],R,3634488961),b=u(b,E,S,w,L[v+4],C,3889429448),w=u(w,b,E,S,L[v+9],k,568446438),S=u(S,w,b,E,L[v+14],T,3275163606),E=u(E,S,w,b,L[v+3],R,4107603335),b=u(b,E,S,w,L[v+8],C,1163531501),w=u(w,b,E,S,L[v+13],k,2850285829),S=u(S,w,b,E,L[v+2],T,4243563512),E=u(E,S,w,b,L[v+7],R,1735328473),b=u(b,E,S,w,L[v+12],C,2368359562),w=l(w,b,E,S,L[v+5],N,4294588738),S=l(S,w,b,E,L[v+8],U,2272392833),E=l(E,S,w,b,L[v+11],F,1839030562),b=l(b,E,S,w,L[v+14],x,4259657740),w=l(w,b,E,S,L[v+1],N,2763975236),S=l(S,w,b,E,L[v+4],U,1272893353),E=l(E,S,w,b,L[v+7],F,4139469664),b=l(b,E,S,w,L[v+10],x,3200236656),w=l(w,b,E,S,L[v+13],N,681279174),S=l(S,w,b,E,L[v+0],U,3936430074),E=l(E,S,w,b,L[v+3],F,3572445317),b=l(b,E,S,w,L[v+6],x,76029189),w=l(w,b,E,S,L[v+9],N,3654602809),S=l(S,w,b,E,L[v+12],U,3873151461),E=l(E,S,w,b,L[v+15],F,530742520),b=l(b,E,S,w,L[v+2],x,3299628645),w=h(w,b,E,S,L[v+0],G,4096336452),S=h(S,w,b,E,L[v+7],O,1126891415),E=h(E,S,w,b,L[v+14],V,2878612391),b=h(b,E,S,w,L[v+5],A,4237533241),w=h(w,b,E,S,L[v+12],G,1700485571),S=h(S,w,b,E,L[v+3],O,2399980690),E=h(E,S,w,b,L[v+10],V,4293915773),b=h(b,E,S,w,L[v+1],A,2240044497),w=h(w,b,E,S,L[v+8],G,1873313359),S=h(S,w,b,E,L[v+15],O,4264355552),E=h(E,S,w,b,L[v+6],V,2734768916),b=h(b,E,S,w,L[v+13],A,1309151649),w=h(w,b,E,S,L[v+4],G,4149444226),S=h(S,w,b,E,L[v+11],O,3174756917),E=h(E,S,w,b,L[v+2],V,718787259),b=h(b,E,S,w,L[v+9],A,3951481745),w=i(w,g),b=i(b,f),E=i(E,m),S=i(S,y);var _=c(w)+c(b)+c(E)+c(S);return _.toLowerCase()};